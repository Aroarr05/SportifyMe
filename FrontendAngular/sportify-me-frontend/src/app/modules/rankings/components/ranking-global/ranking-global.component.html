<div class="container mx-auto p-4">
  <h2 class="text-2xl font-bold mb-4">üèÜ Ranking del Desaf√≠o</h2>

  <!-- Selector de desaf√≠o -->
  <div class="mb-4">
    <label class="block text-sm font-medium mb-2">Seleccionar Desaf√≠o:</label>
    <select 
      [(ngModel)]="desafioId" 
      (change)="cambiarDesafio(desafioId)"
      class="border rounded p-2"
    >
      <option [value]="1">Desaf√≠o 1</option>
      <option [value]="2">Desaf√≠o 2</option>
      <option [value]="3">Desaf√≠o 3</option>
    </select>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="text-center p-8">
    <p>Cargando ranking...</p>
  </div>

  <!-- Error -->
  <div *ngIf="error && !loading" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
    <p>{{ error }}</p>
    <button 
      *ngIf="!error.includes('Redirigiendo')"
      (click)="reintentar()" 
      class="mt-2 bg-red-600 text-white px-4 py-2 rounded"
    >
      Reintentar
    </button>
  </div>

  <!-- Ranking -->
  <div *ngIf="!loading && !error && ranking.length > 0" class="overflow-x-auto">
    <table class="min-w-full bg-white border">
      <thead>
        <tr class="bg-gray-100">
          <th class="py-2 px-4 border">Posici√≥n</th>
          <th class="py-2 px-4 border">Usuario</th>
          <th class="py-2 px-4 border">Puntuaci√≥n</th>
          <th class="py-2 px-4 border">Progreso</th>
        </tr>
      </thead>
      <tbody>
        <tr 
          *ngFor="let item of ranking; let i = index" 
          [class]="getRowClass(i)"
          class="border"
        >
          <td class="py-2 px-4 border text-center">
            <span class="font-bold">{{ i + 1 }}</span>
            <span class="ml-1">{{ getMedal(i) }}</span>
          </td>
          <td class="py-2 px-4 border">{{ item.usuario?.nombre || 'Usuario' }}</td>
          <td class="py-2 px-4 border">{{ item.puntuacion || 0 }}</td>
          <td class="py-2 px-4 border">{{ item.progresoTotal || 0 }}%</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Empty state -->
  <div *ngIf="!loading && !error && ranking.length === 0" class="text-center p-8">
    <p>No hay datos de ranking para este desaf√≠o.</p>
  </div>
</div>