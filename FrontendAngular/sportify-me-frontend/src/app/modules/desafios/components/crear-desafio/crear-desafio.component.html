<div class="container mx-auto px-4 py-8 max-w-3xl">
  <h1 class="text-3xl font-bold text-gray-800 mb-8">Crear Nuevo Desafío</h1>

  <app-error-alert *ngIf="error" [message]="error"></app-error-alert>

  <form [formGroup]="desafioForm" (ngSubmit)="onSubmit()" class="space-y-6">
    <div>
      <label for="nombre" class="block text-sm font-medium text-gray-700 mb-1">Nombre del Desafío</label>
      <input
        type="text"
        id="nombre"
        formControlName="nombre"
        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"
        placeholder="Ej: Carrera de 5km en menos de 30 minutos"
      >
      <div *ngIf="desafioForm.get('nombre')?.invalid && (desafioForm.get('nombre')?.dirty || desafioForm.get('nombre')?.touched)"
           class="mt-1 text-sm text-red-600">
        <div *ngIf="desafioForm.get('nombre')?.errors?.['required']">El nombre es requerido</div>
        <div *ngIf="desafioForm.get('nombre')?.errors?.['maxlength']">Máximo 100 caracteres</div>
      </div>
    </div>

    <div>
      <label for="descripcion" class="block text-sm font-medium text-gray-700 mb-1">Descripción</label>
      <textarea
        id="descripcion"
        formControlName="descripcion"
        rows="4"
        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"
        placeholder="Describe el desafío en detalle..."
      ></textarea>
      <div *ngIf="desafioForm.get('descripcion')?.invalid && (desafioForm.get('descripcion')?.dirty || desafioForm.get('descripcion')?.touched)"
           class="mt-1 text-sm text-red-600">
        <div *ngIf="desafioForm.get('descripcion')?.errors?.['required']">La descripción es requerida</div>
        <div *ngIf="desafioForm.get('descripcion')?.errors?.['maxlength']">Máximo 500 caracteres</div>
      </div>
    </div>

    <div>
      <label for="tipoActividad" class="block text-sm font-medium text-gray-700 mb-1">Tipo de Actividad</label>
      <select
        id="tipoActividad"
        formControlName="tipoActividad"
        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"
      >
        <option *ngFor="let tipo of tiposActividad" [value]="tipo">{{ tipo }}</option>
      </select>
    </div>

    <div>
      <label for="objetivo" class="block text-sm font-medium text-gray-700 mb-1">Objetivo</label>
      <input
        type="text"
        id="objetivo"
        formControlName="objetivo"
        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"
        placeholder="Ej: Correr 5km en menos de 30 minutos"
      >
      <div *ngIf="desafioForm.get('objetivo')?.invalid && (desafioForm.get('objetivo')?.dirty || desafioForm.get('objetivo')?.touched)"
           class="mt-1 text-sm text-red-600">
        <div *ngIf="desafioForm.get('objetivo')?.errors?.['required']">El objetivo es requerido</div>
        <div *ngIf="desafioForm.get('objetivo')?.errors?.['maxlength']">Máximo 200 caracteres</div>
      </div>
    </div>

    <div>
      <label for="fechaLimite" class="block text-sm font-medium text-gray-700 mb-1">Fecha Límite</label>
      <input
        type="datetime-local"
        id="fechaLimite"
        formControlName="fechaLimite"
        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"
      >
      <div *ngIf="desafioForm.get('fechaLimite')?.invalid && (desafioForm.get('fechaLimite')?.dirty || desafioForm.get('fechaLimite')?.touched)"
           class="mt-1 text-sm text-red-600">
        <div *ngIf="desafioForm.get('fechaLimite')?.errors?.['required']">La fecha límite es requerida</div>
      </div>
    </div>

    <div class="flex justify-end space-x-4">
      <button
        type="button"
        routerLink="/desafios"
        class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50"
      >
        Cancelar
      </button>
      <button
        type="submit"
        [disabled]="desafioForm.invalid || loading"
        class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-blue-300 transition-colors"
      >
        <span *ngIf="!loading">Crear Desafío</span>
        <span *ngIf="loading">Creando...</span>
      </button>
    </div>
  </form>
</div>